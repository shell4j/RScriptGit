data[[i]] <- NULL
}
dim(data)
a3=data[6:15]
View(a3)
a3=colSums(a3)
View(a3)
?colSums
mode(a3)
names(a3)="A3"
data1=cbind(a3,data)
a3=colsum(data[,6:15])
a3=colSums(data[,6:15])
a=data[,6:15]
View(a)
colSums(a)
a=rowSums(a)
rbind(data,a)
data=rbind(data,a)
View(data)
dim(data)
data[,6:15]=NULL
dim(data)
a=data[,6:15]
a=rowSums(a)
data=cbind(data,a)
View(data)
data=data[,-c(6:15)]
A6=data[,c(9:18)]
A6=rowSums(A6)
data=rbind(data,A6)
data=data[,-c(9:18)]
View(data)
data=cbind(data,A6)
data=read.csv("D:/Kaggle/DMinART/chineseAB.csv",stringsAsFactors=FALSE)
dim(data)
data[is.na(data)]=0
names=names(data)
for (i in names)
{
u <- unique(data[[i]])
if (length(u) == 1)
{
data[[i]] <- NULL
}
A3=data[,6:15]
A3=rowSums(A3)
data=cbind(data,A3)
data=data[,-c(6:15)]
A6=data[,9:18]
A6=rowSums(A6)
data=cbind(data,A6)
data=data[,-c(9:18)]
dim(data)
View(data)
summary(data$A5_23_OTHER)
data=data[,-c(8,14)]
View(data)
write.csv(data,""D:/Kaggle/DMinART/post_chineseAB.csv"")
write.csv(data,"D:/Kaggle/DMinART/post_chineseAB.csv")
?rpart
library(rpart)
?rpart
library(rattle)
rattle()
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
dim(data)
View(data)
source('D:/Kaggle/DMinART/preC.R')
view(data)
dim(data)
View(data)
source('D:/Kaggle/DMinART/preC.R')
View(data)
dim(data)
data=read.csv("D:/Kaggle/DMinART/touchF.csv",stringsAsFactors=FALSE)
View(data)
data=read.csv("D:/Kaggle/DMinART/infoE.csv",stringsAsFactors=FALSE)
View(data)
data=data[,-1]
View(data)
??fa
factanal(data,2)
factanal(data)
factanal(data,1)
factanal(data,factors = 2)
fa=factanal(data,factors = 1)
fa=factanal(data,factors = 1,scores = "regression")
sc=fa$scores
summary(sc)
?factanal
?fa
library(psych)
?fa()
ans=fa(data,2)
ans=fa(data,1)
summary(ans)
?factor.plot
factor.plot(ans,cut=.5)
fa.diagram(ans)
data=read.csv("D:/Kaggle/DMinART/touchF.csv",stringsAsFactors=FALSE)
View(data)
data=data[,-9]
library(psych)
fa.model=fa(data,factor=5)
fa.model
fa.plot(fa.model)
model=factanal(data,5)
summary(model)
fa.diagram(fa.model)
data1=fa[,1:8]
data1=data[,1:8]
famodel=fa(data1,2)
famodel=fa(data1,1)
fa.plot(famodel)
fa.diagram(famodel)
data=read.csv("D:/Kaggle/DMinART/touchF.csv",stringsAsFactors=FALSE)
View(data)
data1=data[,1:8]
library(psych)
fa.model=fa(data1,3)
fa.model=fa(data1,2)
fa.model=fa(data1,1)
fa.diagram(fa.model)
data2=data[,10:13]
data1=cbind(data1,data2)
fa.model=fa(data1,2)
d=read.csv("D:/Kaggle/DMinART/chineseAB.csv",stringsAsFactors=FALSE)
View(d)
crosstable(d$A7,d$B1)
CrossTable(d$A7,d$B1)
??crossTable
library(arules)
CrossTable(d$A7,d$B1)
crossTable(d$A7,d$B1)
?cancor
data(LifeCycleSavings)
data()
data(LifeCycleSavings)
View(LifeCycleSavings)
pop <- LifeCycleSavings[, 2:3]
oec <- LifeCycleSavings[, -(2:3)]
cancor(pop, oec)
d=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
View(d)
d1=d[,1:18]
library(psych)
fa=fa(d1)
fa=fa(d1,3)
fa=fa(d1,2)
fa=fa(d1)
fa.diagram(fa)
?fa
cov=cov(d1)
cor=cov2cor(cov)
View(cor)
fa.parallel(cor,fa="fa",show.legend = FALSE)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=4,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
summary(fa)
fa.plot(fa)
factanal(cor,factors = 3)
factanal(d1,factors = 3)
factanal(d1,factors = 4)
factanal(d1,factors = 2)
factanal(d1,factors = 3)
data=read.csv("D:/Kaggle/DMinART/touchF.csv",stringsAsFactors=FALSE)
View(data)
d1=data[,1:8]
cov=cov(d1)
cor=cov2cor(cov)
library(psych)
fa.parallel(cor,fa="fa",show.legend = FALSE)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
d1=d[,1:18]
d1=data[,1:18]
names(d1)
data=read.csv("D:/Kaggle/DMinART/touchF.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/infoE.csv",stringsAsFactors=FALSE)
library(psych)
dim(data)
d1=data[,1:8]
names(d1)=c("书籍","报纸杂志","录制音乐","电影","电视","电脑","艺术手工","表演艺术")
cov=cov(d1)
cor=cov2cor(cov)
fa.parallel(cor,fa="fa",show.legend = FALSE)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
d1=data[,1:18]
names(d1)=c("毛泽东","李娜","老子","和谐","仁爱",
"道","瓷器","书法","昆曲","珠穆朗玛峰","珠子","白鳍豚"
,"太极拳","麻将","白酒","长城","丝绸之路","中秋节")
factanal(d1,factors = 3)
fa=factanal(d1,factors = 3)
fa.diagram(fa)
fa.plot(fa)
fa.diagram(fa)
library(psych)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
cov=cov(d1)
cor=cov2cor(cov)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
names(d1)=c("毛泽东","李娜","老子","和谐","仁爱",
"道","瓷器","书法","昆曲","珠穆朗玛峰","竹子","白鳍豚"
,"太极拳","麻将","白酒","长城","丝绸之路","中秋节")
#fa=factanal(d1,factors = 3)
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
?"psych"
fa.graph(fa)
test.simple <- fa(item.sim(16),2,rotate="oblimin")
#if(require(Rgraphviz)) {fa.graph(test.simple) }
fa.diagram(test.simple)
f3 <- fa(Thurstone,3,rotate="cluster")
fa.diagram(f3,cut=.4,digits=2)
f3l <- f3$loadings
fa.diagram(f3l,main="input from a matrix")
Phi <- f3$Phi
fa.diagram(f3l,Phi=Phi,main="Input from a matrix")
fa.diagram(ICLUST(Thurstone,2,title="Two cluster solution of Thurstone"),main="Input from ICLUST")
het.diagram(Thurstone,levels=list(1:4,5:8,3:7))
data=read.csv("D:/Kaggle/DMinART/touchF.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/infoE.csv",stringsAsFactors=FALSE)
library(psych)
View(data)
library(ggplot2)
demo(ggplot2)
?"ggplot2"
?ggplot2
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
d1=data[,1:18]
names(d1)=c("毛泽东","李娜","老子","和谐","仁爱",
"道","瓷器","书法","昆曲","珠穆朗玛峰","竹子","白鳍豚"
,"太极拳","麻将","白酒","长城","丝绸之路","中秋节")
#fa=factanal(d1,factors = 3)
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
d1=data[,1:18]
names(d1)=c("毛泽东","李娜","老子","和谐","仁爱",
"道","瓷器","书法","昆曲","珠穆朗玛峰","竹子","白鳍豚"
,"太极拳","麻将","白酒","长城","丝绸之路","中秋节")
#fa=factanal(d1,factors = 6)
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
d1=data[,1:18]
names(d1)=c("毛泽东","李娜","老子","和谐","仁爱",
"道","瓷器","书法","昆曲","珠穆朗玛峰","竹子","白鳍豚"
,"太极拳","麻将","白酒","长城","丝绸之路","中秋节")
#fa=factanal(d1,factors = 6)
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa=fa(cor,nfactors=6,rotate="varimax",fm="pa")
fa.diagram(fa)
install.packages('Rz')
library(Rz)
install.packages('vcd')
help()
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
View(data)
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
c=c(5:8,10,15,16)
data=data[,c]
data1=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
data=cbind(data,data1)
View(data)
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
View(data)
library(rpart)
?rpart
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
c=c(3:8,10,15,16)
data=data[,c]
names(data)=c("国家","语言","性别","年龄","就业状况","职业内容","中文水平"
,"教育水平","收入水平")
library(rpart)
fit=rpart("中文水平"~"国家"+"语言"+"性别"+
"年龄"+"就业状况"+"职业内容"+"教育水平"+"收入水平",data=data)
plot(fit)
head(data)
fit=rpart(data$V7~.,data=data)
names(data)=c("国家","语言","性别","年龄","就业状况","职业内容","y"
,"教育水平","收入水平")
library(rpart)
fit=rpart(y~.,data=data)
plot(fit)
rpart.plot::rpart.plot(fit)
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
c=c(3:8,15,16,10)
data=data[,c]
View(data)
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
c=c(3:8,15,16,10)
data=data[,c]
View(data)
?as.factor
for (i in ncol(data)){
data[[i]]=as.factor(data[[i]],ordered=FALSE)
}
for (i in ncol(data)){
data[[i]]=as.factor(data[[i]],order=FALSE)
}
for (i in ncol(data)){
data[[i]]=as.factor(data[[i]])
}
for (i in ncol(data)){
data[[i]]=as.factor(data[[i]])
is.ordered(data[[i]])
}
for (i in ncol(data)){
data[[i]]=as.factor(data[[i]])
if(i!=3 & i!=6)
data[[i]]=as.ordered(data[[i]])
}
names(data)
library(rpart)
fit=rpart(B1~.,data=data)
plot(fit)
mode(data)
summary(fit)
write.csv(data,"D:/Kaggle/DMinART/decision_chineseAB.csv")
library(rattle)
rattle()
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
c=c(3:8,15,16,10)
data=data[,c]
names(data)=c("国家","语言","性别","年龄",
"就业状况","职业内容","教育水平","收入水平","y")
for (i in ncol(data)){
data[[i]]=as.factor(data[[i]])
}
write.csv(data,"D:/Kaggle/DMinART/decision_chineseAB.csv")
summary(data)
nrow(data)
nrow(data[,y==1])
namesnames)
names(data)
nrow(data[,data$y==1])
nrow(data[,data$y])
nrow(data[data$y==1,])
nrow(data[data$y==2,])
nrow(data[data$y>1,])
nrow(data[data$y!=1,])
data1=data[data$y!=1,]
data2=data[data$y==1,]
rbind(data1,data2)
data=rbind(data1,data2)
write.csv(data,"D:/Kaggle/DMinART/decision_chineseAB1.csv")
source('D:/RScriptGit/test/decisionTree.R', encoding = 'UTF-8')
?rpart
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
data=read.csv("D:/Kaggle/DMinART/levelB.csv",stringsAsFactors=FALSE)
View(data)
data=read.csv("D:/Kaggle/DMinART/levelB.csv",stringsAsFactors=FALSE)
View(daTA)
View(data)
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
View(data)
data=read.csv("D:/Kaggle/DMinART/post_chineseAB.csv",stringsAsFactors=FALSE)
c=c(3:9,15,16,10)
data=data[,c]
for (i in ncol(data)){
data[[i]]=as.factor(data[[i]])
}
write.csv(data,"D:/Kaggle/DMinART/decision_chineseAB.csv")
library(rattle)
rattle()
data=read.csv("D:/Kaggle/DMinART/levelB.csv",stringsAsFactors=FALSE)
View(data)
data=data[,-5]
View(data)
data=read.csv("D:/Kaggle/DMinART/levelB.csv",stringsAsFactors=FALSE)
data=data[,-5]
write_csv(data,"D:/Kaggle/DMinART/dataB.csv")
write.csv(data,"D:/Kaggle/DMinART/dataB.csv")
data=read.csv("D:/Kaggle/DMinART/knowC.csv",stringsAsFactors=FALSE)
#data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
d1=data[,1:18]
names(d1)=c("毛泽东","李娜","老子","和谐","仁爱",
"道","瓷器","书法","昆曲","珠穆朗玛峰","竹子","白鳍豚"
,"太极拳","麻将","白酒","长城","丝绸之路","中秋节")
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa=fa(cor,nfactors=6,rotate="varimax",fm="pa")
fa.diagram(fa)
fa.parallel(cor,fa="fa",show.legend = FALSE)
?fa.parallel
fa.parallel(cor)
fa.diagram(fa)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
summary(fa)
fa
data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
View(data)
source('D:/Kaggle/DMinART/testE.R')
library(readr)
data=read_csv("D:/Kaggle/DMinART/rawData1.csv")
View(data)
#data1=data[,1:31]
#write_csv(data1,"D:/Kaggle/DMinART/basicA.csv")
write_csv(data1,"D:/Kaggle/DMinART/infoE.csv")
d=data[,data$E3]
data=read.csv("D:/Kaggle/DMinART/infoE.csv",stringsAsFactors=FALSE)
data=cbind(data,d)
write_csv(data1,"D:/Kaggle/DMinART/infoE.csv")
write_csv(data,"D:/Kaggle/DMinART/infoE.csv")
data=read.csv("D:/Kaggle/DMinART/infoE.csv",stringsAsFactors=FALSE)
View(data)
summary(d)
d=data$E3
data=read.csv("D:/Kaggle/DMinART/infoE.csv",stringsAsFactors=FALSE)
data=read_csv("D:/Kaggle/DMinART/rawData1.csv")
View(data)
ncol(data)
data=read_csv("D:/Kaggle/DMinART/rawData1.csv")
c=c(92:95,104,39)
dataE=data[,c]
write_csv(data1,"D:/Kaggle/DMinART/infoE.csv")
write.csv(data,"D:/Kaggle/DMinART/infoE.csv")
View(data)
write.csv(dataE,"D:/Kaggle/DMinART/infoE.csv")
View(dataE)
d1=dataE
names(d1)=c("广播电视","报纸杂志","家人朋友","互联网","阅读方式","信息来源")
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa.parallel(cor)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
d1=d1[,1:4]
cov=cov(d1)
cor=cov2cor(cov)
fa.parallel(cor)
fa.diagram(fa)
d1=d1[,1:4]
cov=cov(d1)
cor=cov2cor(cov)
fa.parallel(cor)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
fa
rattle()
data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
d1=data
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa.parallel(cor)
fa=fa(cor,nfactors=6,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=5,rotate="varimax",fm="pa")
fa.diagram(fa)
fa.parallel(cor)
fa=fa(cor,nfactors=4,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
fa
data=read.csv("D:/Kaggle/DMinART/reasonD.csv",stringsAsFactors=FALSE)
View(data)
data=read.csv("D:/Kaggle/DMinART/touchF.csv",stringsAsFactors=FALSE)
View(data)
d1=data[,1:8]
names(d1)=c("书籍","报纸杂志","录音音乐","电影","电视","电脑"
,"手工艺术品","表演艺术")
library(psych)
cov=cov(d1)
cor=cov2cor(cov)
fa.parallel(cor)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
fa.parallel(cor)
fa=fa(cor,nfactors=2,rotate="varimax",fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=2,fm="pa")
fa.diagram(fa)
fa=fa(cor,nfactors=3,rotate="varimax",fm="pa")
fa.diagram(fa)
